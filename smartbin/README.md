# SmartBin 智能归档箱

SmartBin 是一款运行在 Windows/macOS 系统上的桌面应用程序，它颠覆了传统回收站的"删除"逻辑，将其转化为"收纳"逻辑。用户只需将杂乱的文件拖拽至屏幕上的悬浮图标中，系统便会自动分析文件属性，在指定目录（如桌面）创建分类文件夹（如"图片"、"文档"、"视频"），并将文件精准归位。

## 功能特性

### 核心功能
- **智能文件识别**：基于文件扩展名和文件头（Magic Number）的双重检测
- **自动分类整理**：自动将文件移动到对应的分类文件夹
- **悬浮图标界面**：美观的悬浮图标，支持拖拽操作
- **系统托盘集成**：最小化到系统托盘，不占用桌面空间
- **操作历史记录**：记录所有文件操作，支持撤销功能

### 高级功能
- **伪装文件检测**：识别伪装成其他类型的文件
- **防冲突机制**：支持重命名、覆盖、跳过等多种冲突处理策略
- **自定义设置**：可调整目标目录、界面透明度等
- **批量处理**：支持同时拖拽多个文件

## 技术架构

### 模块化设计
- **交互层**：负责显示悬浮图标、接收鼠标事件、展示动画反馈
- **控制层**：负责调度任务，管理文件队列，协调识别引擎和执行器的工作流程
- **引擎层**：核心处理单元，包含文件类型识别器和规则处理器
- **数据层**：负责读写硬盘文件、记录操作日志、存储用户配置

### 技术栈
- **GUI 框架**：PyQt5 - 跨平台桌面应用开发
- **文件处理**：Python 标准库 - 文件系统操作
- **文件识别**：自定义 Magic Number 检测引擎
- **配置管理**：JSON 格式配置文件

## 安装使用

### 环境要求
- Python 3.7+
- Windows/macOS 操作系统

### 安装步骤

1. 克隆或下载项目代码

2. 安装依赖包：
```bash
pip install -r smartbin/requirements.txt
```

3. 运行程序：
```bash
python -m smartbin.main
```

### 使用方法

1. **启动程序**：运行主程序后，屏幕上会出现一个蓝色的悬浮图标
2. **拖拽文件**：将需要整理的文件拖拽到悬浮图标上
3. **自动分类**：程序会自动识别文件类型并移动到对应的文件夹
4. **查看历史**：右键点击系统托盘图标，选择"操作历史"查看所有操作
5. **撤销操作**：如需撤销上一步操作，右键点击系统托盘图标，选择"撤销上一步"

## 配置说明

### 默认分类规则

程序默认支持以下文件分类：

| 分类 | 支持的文件类型 |
|------|---------------|
| 图片 | .jpg, .jpeg, .png, .gif, .bmp, .webp, .svg |
| 文档 | .pdf, .doc, .docx, .txt, .rtf, .xls, .xlsx, .ppt, .pptx |
| 视频 | .mp4, .avi, .mkv, .mov, .wmv, .flv, .webm |
| 音频 | .mp3, .wav, .flac, .aac, .ogg, .wma |
| 压缩包 | .zip, .rar, .7z, .tar, .gz |
| 代码 | .py, .js, .html, .css, .java, .cpp, .c, .h |
| 安装包 | .exe, .msi, .dmg, .pkg, .deb, .rpm |

### 自定义配置

通过系统托盘菜单的"设置"选项，可以配置：

- **目标目录**：文件整理的目标文件夹（默认为桌面）
- **冲突策略**：文件名冲突时的处理方式（重命名/覆盖/跳过）
- **界面透明度**：悬浮图标的透明度设置

## 项目结构

```
smartbin/
├── __init__.py          # 包初始化文件
├── config.py            # 配置管理模块
├── file_recognizer.py   # 文件识别引擎
├── file_processor.py    # 文件处理器
├── gui.py              # 图形界面模块
├── main.py             # 程序入口
└── requirements.txt    # 依赖包列表
```

## 核心功能说明

### 文件识别引擎

程序采用三级检测机制：

1. **一级检测（后缀名）**：检查文件扩展名
2. **二级检测（文件头）**：读取文件流的前 10-20 字节，比对标准文件头数据库
3. **三级检测（内容分析）**：对文本文件进行关键词提取

### 防冲突机制

当目标文件夹存在同名文件时，提供以下策略：

- **重命名**：自动重命名为"文件名(1).扩展名"
- **覆盖**：直接覆盖目标文件
- **跳过**：跳过该文件，不进行移动

### 操作历史与撤销

程序会记录所有文件操作，包括：
- 操作时间
- 操作类型（移动）
- 原路径
- 目标路径
- 文件大小
- 文件哈希值

用户可以随时撤销上一步操作，将文件移回原位置。

## 开发路线图

- [x] V0.1 (命令行版)：核心识别算法
- [x] V0.5 (界面版)：基础 GUI 界面
- [x] V1.0 (正式版)：悬浮图标、拖拽投放、自动建文件夹、撤销功能
- [ ] V1.1 (增强版)：热区模式、内容分析 AI
- [ ] V2.0 (专业版)：云端同步、多设备支持

## 注意事项

1. 程序需要文件系统访问权限
2. 建议定期备份重要文件
3. 首次运行会在用户目录下创建 `.smartbin` 配置文件夹
4. 悬浮图标可以拖动到屏幕任意位置

## 许可证

本项目采用 MIT 许可证。

## 联系方式

如有问题或建议，欢迎提交 Issue 或 Pull Request。